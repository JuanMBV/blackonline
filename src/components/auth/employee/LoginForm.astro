<section>
  <h2 class="text-4xl text-center font-serif">INICIAR COMO EMPLEADO</h2>
  
  <form class="px-7 pt-4 flex flex-col lg:block">
    <div class="flex flex-col pb-5">
      <input id="email" type="email" placeholder="Correo electrónico" required class="border-2 border-gray-300 rounded-xl max-w-full text-center text-xl px-5 py-1">
    </div>

    <div class="flex flex-col pb-5">
      <input id="pass" type="password" maxlength="20" placeholder="Contraseña" required class="border-2 border-gray-300 rounded-xl max-w-full text-center text-xl px-5 py-1">
    </div>

    <button type="submit" class="bg-black text-white text-xl rounded-xl py-2 px-56 mb-6">Ingresar</button>

  </form>
</section>

<script>
  document.querySelector('form').addEventListener('submit', e => {
    e.preventDefault()
    
    const email = document.getElementById('email') as HTMLInputElement;
    const pass = document.getElementById('pass') as HTMLInputElement;

    const data = {
      email: email.value,
      password: pass.value
    }

    // API: https://api.blackonline.juanmbv.site

    fetch('http://localhost:8080/auth/login/employee', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    })
    .then(res => {
      if(!res.ok) {
        alert('Correo o contraseña incorrectos')
        throw new Error('Ocurrio un error al iniciar sesion del empleado')    
      }
      return res.json()
    })
    .then(data => {
      localStorage.setItem('token', data.token)
      window.location.href = '/employee/console/inventory'
    })
    .catch(error => {
      console.error('Error:', error)
    })

  })
</script>